# 1. 工作流名称（可选，但建议加）
name: Build Go Project

# 2. 触发条件（必填，比如push/PR时触发）
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

# 3. 核心任务（必填！你缺失的关键字段）
jobs:
  # 定义一个名为build的任务（名称可自定义）
  build:
    # 运行环境（必填）
    runs-on: ubuntu-latest
    # 任务步骤（steps必须嵌套在这里，而非顶级）
    steps:
      # 步骤1：拉取代码
      - name: Checkout code
        uses: actions/checkout@v4

      # 步骤2：设置Go环境（根据你的Go版本调整）
      - name: Set up Go
        uses: actions/setup-go@v5
        with:
          go-version: '1.26'

      # 步骤3：初始化Go模块+生成go.sum（解决之前的依赖问题）
      - name: Init Go mod and tidy
        run: |
          # 若项目不在根目录，需先cd到对应目录，比如 cd ./src
          if [ ! -f go.mod ]; then
            go mod init github.com/zan66/xx/
          fi
          go mod tidy

      # 步骤4：构建项目（示例，可替换为你的实际构建命令）
      - name: Build project
        run: go build -v ./...
